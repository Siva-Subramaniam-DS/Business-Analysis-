## Phase 1: Data Exploration and Preprocessing

**Install the Package**


```python
# Install required packages
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from prettytable import PrettyTable
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
from tabulate import tabulate
```

**Load the dataset**

**1. Dataset Overview**


```python
# Load the Excel file
file_path = 'Data set for Ba.xlsx'
excel_file = pd.ExcelFile(file_path)

# Get all sheet names
sheet_names = excel_file.sheet_names

# Dictionary to store dataframes
dfs = {}

# Loop through each sheet and load it into a dataframe
for sheet in sheet_names:
    try:
        df = excel_file.parse(sheet)
        # Store non-empty dataframes in the dictionary
        if not df.empty:
            dfs[sheet] = df
            print(f'Loaded sheet: {sheet} with shape {df.shape}')
    except Exception as e:
        print(f'Error loading sheet {sheet}: {e}')

# Display the loaded sheet names
print("\nLoaded sheets:", list(dfs.keys()))

```

    Loaded sheet: User Acquisition with shape (6, 9)
    Loaded sheet: Traffic Aquisition with shape (6, 11)
    Loaded sheet: Event Report with shape (379, 5)
    Loaded sheet: Conversion Report with shape (18, 4)
    Loaded sheet: Pages & Screens Report with shape (42, 8)
    Loaded sheet: Demographics Report with shape (47, 10)
    Loaded sheet: Citiwise Report with shape (574, 10)
    Loaded sheet: Gender Report with shape (3, 10)
    Loaded sheet: User By Interest with shape (89, 10)
    Loaded sheet: User by Language with shape (24, 10)
    Loaded sheet: User By Age with shape (7, 10)
    Loaded sheet: Google Ads Report with shape (15, 12)
    
    Loaded sheets: ['User Acquisition', 'Traffic Aquisition', 'Event Report', 'Conversion Report', 'Pages & Screens Report', 'Demographics Report', 'Citiwise Report', 'Gender Report', 'User By Interest', 'User by Language', 'User By Age', 'Google Ads Report']


**Defining a Variables**


```python
# Load the Excel file
file_path = 'Data set for Ba.xlsx'
excel_file = pd.ExcelFile(file_path)

# Get all sheet names
user_acquisition_df = excel_file.parse('User Acquisition')
traffic_acquisition_df = excel_file.parse('Traffic Aquisition')
event_report_df = excel_file.parse('Event Report')
conversion_report_df = excel_file.parse('Conversion Report')
Pages_df = excel_file.parse('Pages & Screens Report')
demographics_report_df = excel_file.parse('Demographics Report')
citiwise_report_df = excel_file.parse('Citiwise Report')
gender_report_df = excel_file.parse('Gender Report')
interest_report_df = excel_file.parse('User By Interest')
language_report_df = excel_file.parse('User by Language')
age_report_df = excel_file.parse('User By Age')
google_report_df = excel_file.parse('Google Ads Report')
```


```python
# Load the Excel file
file_path = 'Data set for Ba.xlsx'
excel_file = pd.ExcelFile(file_path)

sheet_names = [
    'User Acquisition', 'Traffic Aquisition', 'Event Report', 'Conversion Report',
    'Pages & Screens Report', 'Demographics Report', 'Citiwise Report',
    'Gender Report', 'User By Interest', 'User by Language', 'User By Age',
    'Google Ads Report'
]

# Load sheets into dictionary
dfs = {sheet: excel_file.parse(sheet) for sheet in sheet_names}

# Prepare summary data
summary_data = []
for sheet, df in dfs.items():
    total_missing = df.isnull().sum().sum()
    duplicates = df.duplicated().sum()
    summary_data.append({
        "Sheet Name": sheet,
        "Rows": df.shape[0],
        "Columns": df.shape[1],
        "Missing Values (total)": total_missing,
        "Duplicates": duplicates
    })

# Convert summary to DataFrame and print pretty table
summary_df = pd.DataFrame(summary_data)
print("=== Summary of All Sheets ===")
print(tabulate(summary_df, headers='keys', tablefmt='fancy_grid', showindex=False))

# Print sample data preview for each sheet separately
for sheet, df in dfs.items():
    print(f"\n=== Sample Data: {sheet} ===")
    print(tabulate(df.head(), headers='keys', tablefmt='fancy_grid', showindex=False))
```

    === Summary of All Sheets ===
    ╒════════════════════════╤════════╤═══════════╤══════════════════════════╤══════════════╕
    │ Sheet Name             │   Rows │   Columns │   Missing Values (total) │   Duplicates │
    ╞════════════════════════╪════════╪═══════════╪══════════════════════════╪══════════════╡
    │ User Acquisition       │      6 │         9 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ Traffic Aquisition     │      6 │        11 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ Event Report           │    379 │         5 │                        1 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ Conversion Report      │     18 │         4 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ Pages & Screens Report │     42 │         8 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ Demographics Report    │     47 │        10 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ Citiwise Report        │    574 │        10 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ Gender Report          │      3 │        10 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ User By Interest       │     89 │        10 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ User by Language       │     24 │        10 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ User By Age            │      7 │        10 │                        0 │            0 │
    ├────────────────────────┼────────┼───────────┼──────────────────────────┼──────────────┤
    │ Google Ads Report      │     15 │        12 │                        0 │            0 │
    ╘════════════════════════╧════════╧═══════════╧══════════════════════════╧══════════════╛
    
    === Sample Data: User Acquisition ===
    ╒════════════════════════════════════╤═════════════╤════════════════════╤═══════════════════╤═════════════════════════════╤═══════════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ First user default channel group   │   New users │   Engaged sessions │   Engagement rate │   Engaged sessions per user │   Average engagement time │   Event count │   Conversions │   Total revenue │
    ╞════════════════════════════════════╪═════════════╪════════════════════╪═══════════════════╪═════════════════════════════╪═══════════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ Display                            │        9957 │              12008 │          0.544457 │                     1.20611 │                   58.8621 │        204820 │         37434 │               0 │
    ├────────────────────────────────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Organic Search                     │        7652 │              18141 │          0.81368  │                     2.36704 │                  534.313  │        770710 │        109801 │               0 │
    ├────────────────────────────────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Paid Search                        │        3025 │               4408 │          0.474284 │                     1.45815 │                  102.238  │         81997 │         14770 │               0 │
    ├────────────────────────────────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Direct                             │        1903 │               4975 │          0.318808 │                     2.26136 │                 1128.88   │        227434 │         31093 │               0 │
    ├────────────────────────────────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Unassigned                         │         325 │               1619 │          0.813159 │                     4.98154 │                  798.341  │         33320 │           789 │               0 │
    ╘════════════════════════════════════╧═════════════╧════════════════════╧═══════════════════╧═════════════════════════════╧═══════════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: Traffic Aquisition ===
    ╒═════════════════════════════════╤═════════╤════════════╤════════════════════╤═══════════════════════════════════════╤═════════════════════════════╤══════════════════════╤═══════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Session default channel group   │   Users │   Sessions │   Engaged sessions │   Average engagement time per session │   Engaged sessions per user │   Events per session │   Engagement rate │   Event count │   Conversions │   Total revenue │
    ╞═════════════════════════════════╪═════════╪════════════╪════════════════════╪═══════════════════════════════════════╪═════════════════════════════╪══════════════════════╪═══════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ Unassigned                      │   20263 │      13448 │               1481 │                               34.117  │                    0.073089 │             18.0231  │          0.110128 │        242375 │        114161 │               0 │
    ├─────────────────────────────────┼─────────┼────────────┼────────────────────┼───────────────────────────────────────┼─────────────────────────────┼──────────────────────┼───────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Display                         │    9613 │      18292 │              10613 │                               28.522  │                    1.10403  │              9.06932 │          0.580199 │        165896 │         20031 │               0 │
    ├─────────────────────────────────┼─────────┼────────────┼────────────────────┼───────────────────────────────────────┼─────────────────────────────┼──────────────────────┼───────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Organic Search                  │    7689 │      21241 │              17814 │                              195.943  │                    2.31682  │             29.3023  │          0.838661 │        622410 │         33612 │               0 │
    ├─────────────────────────────────┼─────────┼────────────┼────────────────────┼───────────────────────────────────────┼─────────────────────────────┼──────────────────────┼───────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Direct                          │    4042 │      13220 │               7649 │                              177.171  │                    1.89238  │             17.1359  │          0.578593 │        226536 │         18496 │               0 │
    ├─────────────────────────────────┼─────────┼────────────┼────────────────────┼───────────────────────────────────────┼─────────────────────────────┼──────────────────────┼───────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Paid Search                     │    2909 │       6788 │               3452 │                               36.6532 │                    1.18666  │              8.98998 │          0.508544 │         61024 │          7595 │               0 │
    ╘═════════════════════════════════╧═════════╧════════════╧════════════════════╧═══════════════════════════════════════╧═════════════════════════════╧══════════════════════╧═══════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: Event Report ===
    ╒══════════════════════╤═══════════════╤═══════════════╤════════════════════════╤═════════════════╕
    │ Event name           │   Event count │   Total users │   Event count per user │   Total revenue │
    ╞══════════════════════╪═══════════════╪═══════════════╪════════════════════════╪═════════════════╡
    │ screen_view          │        694729 │         23254 │               30.8659  │               0 │
    ├──────────────────────┼───────────────┼───────────────┼────────────────────────┼─────────────────┤
    │ notification_receive │        125146 │          1700 │              138.897   │               0 │
    ├──────────────────────┼───────────────┼───────────────┼────────────────────────┼─────────────────┤
    │ user_engagement      │        124836 │         22699 │                5.62223 │               0 │
    ├──────────────────────┼───────────────┼───────────────┼────────────────────────┼─────────────────┤
    │ notification_dismiss │         70128 │          1369 │              144       │               0 │
    ├──────────────────────┼───────────────┼───────────────┼────────────────────────┼─────────────────┤
    │ session_start        │         61163 │         23226 │                3.12136 │               0 │
    ╘══════════════════════╧═══════════════╧═══════════════╧════════════════════════╧═════════════════╛
    
    === Sample Data: Conversion Report ===
    ╒═══════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Event name            │   Conversions │   Total users │   Total revenue │
    ╞═══════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ notification_receive  │         94890 │          1311 │               0 │
    ├───────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ session_start         │         56203 │         21674 │               0 │
    ├───────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ first_open            │         22872 │         23059 │               0 │
    ├───────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ app_remove            │         12468 │         12538 │               0 │
    ├───────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Promilo111_otp_screen │          1738 │           855 │               0 │
    ╘═══════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: Pages & Screens Report ===
    ╒══════════════════════════════╤═════════╤═════════╤══════════════════╤═══════════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Page path and screen class   │   Views │   Users │   Views per user │   Average engagement time │   Event count │   Conversions │   Total revenue │
    ╞══════════════════════════════╪═════════╪═════════╪══════════════════╪═══════════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ Flutter                      │  156708 │    8726 │         17.9587  │                   83.4122 │        203901 │           328 │               0 │
    ├──────────────────────────────┼─────────┼─────────┼──────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ MainActivity                 │   44326 │    8978 │          4.93718 │                   78.2922 │         53374 │           101 │               0 │
    ├──────────────────────────────┼─────────┼─────────┼──────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ feeds                        │   18514 │    4358 │          4.24828 │                   61.6001 │         37628 │           253 │               0 │
    ├──────────────────────────────┼─────────┼─────────┼──────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ login                        │   16883 │    7291 │          2.3156  │                   34.8818 │         40772 │           435 │               0 │
    ├──────────────────────────────┼─────────┼─────────┼──────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ my_rewards_screen            │   15381 │    2045 │          7.52127 │                   94.18   │         32910 │             5 │               0 │
    ╘══════════════════════════════╧═════════╧═════════╧══════════════════╧═══════════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: Demographics Report ===
    ╒════════════════╤═════════╤═════════════╤════════════════════╤═══════════════════╤═════════════════════════════╤═══════════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Country        │   Users │   New users │   Engaged sessions │   Engagement rate │   Engaged sessions per user │   Average engagement time │   Event count │   Conversions │   Total revenue │
    ╞════════════════╪═════════╪═════════════╪════════════════════╪═══════════════════╪═════════════════════════════╪═══════════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ India          │   23024 │       22528 │              41479 │          0.593626 │                    1.80156  │                  334.817  │       1312097 │        192766 │               0 │
    ├────────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ United States  │     272 │         213 │                197 │          0.491272 │                    0.724265 │                   50.9632 │          3157 │           643 │               0 │
    ├────────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Canada         │      37 │          18 │                 25 │          0.416667 │                    0.675676 │                   43.2162 │           410 │           121 │               0 │
    ├────────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ (not set)      │      36 │          36 │                 17 │          0.459459 │                    0.472222 │                   24.8056 │           241 │            54 │               0 │
    ├────────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ United Kingdom │      20 │           8 │                 13 │          0.371429 │                    0.65     │                   61.85   │           289 │            43 │               0 │
    ╘════════════════╧═════════╧═════════════╧════════════════════╧═══════════════════╧═════════════════════════════╧═══════════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: Citiwise Report ===
    ╒═════════════╤═════════╤═════════════╤════════════════════╤═══════════════════╤═════════════════════════════╤═══════════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Town/City   │   Users │   New users │   Engaged sessions │   Engagement rate │   Engaged sessions per user │   Average engagement time │   Event count │   Conversions │   Total revenue │
    ╞═════════════╪═════════╪═════════════╪════════════════════╪═══════════════════╪═════════════════════════════╪═══════════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ Bengaluru   │    6097 │        5685 │              15013 │          0.769385 │                     2.46236 │                  762.206  │        607200 │         62939 │               0 │
    ├─────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Patna       │    1594 │        1467 │               2127 │          0.440646 │                     1.33438 │                   98.2221 │         38830 │          6980 │               0 │
    ├─────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Hyderabad   │    1038 │         920 │               1578 │          0.569264 │                     1.52023 │                  243.691  │         96826 │         34103 │               0 │
    ├─────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Indore      │     983 │         915 │               1241 │          0.42646  │                     1.26246 │                   67.8911 │         21383 │          4121 │               0 │
    ├─────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Lucknow     │     897 │         839 │               1125 │          0.45018  │                     1.25418 │                   83.4058 │         21041 │          3650 │               0 │
    ╘═════════════╧═════════╧═════════════╧════════════════════╧═══════════════════╧═════════════════════════════╧═══════════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: Gender Report ===
    ╒══════════╤═════════╤═════════════╤════════════════════╤═══════════════════╤═════════════════════════════╤═══════════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Gender   │   Users │   New users │   Engaged sessions │   Engagement rate │   Engaged sessions per user │   Average engagement time │   Event count │   Conversions │   Total revenue │
    ╞══════════╪═════════╪═════════════╪════════════════════╪═══════════════════╪═════════════════════════════╪═══════════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ unknown  │   13142 │       12691 │              23161 │          0.564077 │                     1.76236 │                   439.578 │        761771 │         93180 │               0 │
    ├──────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ male     │    7218 │        5877 │              10467 │          0.543091 │                     1.45013 │                   128.232 │        282504 │         65651 │               0 │
    ├──────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ female   │    4944 │        4304 │               7877 │          0.63771  │                     1.59324 │                   208.741 │        274254 │         35083 │               0 │
    ╘══════════╧═════════╧═════════════╧════════════════════╧═══════════════════╧═════════════════════════════╧═══════════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: User By Interest ===
    ╒═══════════════════════════════════════════════╤═════════╤═════════════╤════════════════════╤═══════════════════╤═════════════════════════════╤═══════════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Interests                                     │   Users │   New users │   Engaged sessions │   Engagement rate │   Engaged sessions per user │   Average engagement time │   Event count │   Conversions │   Total revenue │
    ╞═══════════════════════════════════════════════╪═════════╪═════════════╪════════════════════╪═══════════════════╪═════════════════════════════╪═══════════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ Shoppers                                      │   10950 │        9256 │              15652 │          0.581534 │                     1.42941 │                   162.835 │        490664 │         86846 │               0 │
    ├───────────────────────────────────────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Media & Entertainment/Comics & Animation Fans │   10946 │        9247 │              15680 │          0.583008 │                     1.43249 │                   165.177 │        491025 │         86845 │               0 │
    ├───────────────────────────────────────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Technology/Mobile Enthusiasts                 │   10934 │        9239 │              15619 │          0.582451 │                     1.42848 │                   162.695 │        489353 │         86742 │               0 │
    ├───────────────────────────────────────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Food & Dining/Cooking Enthusiasts             │    8410 │        6970 │              12332 │          0.602325 │                     1.46635 │                   176.957 │        409713 │         73814 │               0 │
    ├───────────────────────────────────────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Sports & Fitness/Health & Fitness Buffs       │    5844 │        4580 │               8226 │          0.588328 │                     1.4076  │                   155.145 │        257831 │         43074 │               0 │
    ╘═══════════════════════════════════════════════╧═════════╧═════════════╧════════════════════╧═══════════════════╧═════════════════════════════╧═══════════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: User by Language ===
    ╒════════════╤═════════╤═════════════╤════════════════════╤═══════════════════╤═════════════════════════════╤═══════════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Language   │   Users │   New users │   Engaged sessions │   Engagement rate │   Engaged sessions per user │   Average engagement time │   Event count │   Conversions │   Total revenue │
    ╞════════════╪═════════╪═════════════╪════════════════════╪═══════════════════╪═════════════════════════════╪═══════════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ English    │   22495 │       21990 │              40639 │          0.595147 │                     1.80658 │                  341.363  │       1297970 │        189946 │               0 │
    ├────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Hindi      │     586 │         552 │                798 │          0.406314 │                     1.36177 │                   60.0341 │         13523 │          2699 │               0 │
    ├────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Marathi    │      85 │          84 │                 98 │          0.426087 │                     1.15294 │                   38.4823 │          1589 │           323 │               0 │
    ├────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Gujarati   │      78 │          77 │                100 │          0.44843  │                     1.28205 │                   46.5385 │          1794 │           327 │               0 │
    ├────────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ Telugu     │      43 │          42 │                 56 │          0.455285 │                     1.30233 │                   36.6512 │           812 │           170 │               0 │
    ╘════════════╧═════════╧═════════════╧════════════════════╧═══════════════════╧═════════════════════════════╧═══════════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: User By Age ===
    ╒═════════╤═════════╤═════════════╤════════════════════╤═══════════════════╤═════════════════════════════╤═══════════════════════════╤═══════════════╤═══════════════╤═════════════════╕
    │ Age     │   Users │   New users │   Engaged sessions │   Engagement rate │   Engaged sessions per user │   Average engagement time │   Event count │   Conversions │   Total revenue │
    ╞═════════╪═════════╪═════════════╪════════════════════╪═══════════════════╪═════════════════════════════╪═══════════════════════════╪═══════════════╪═══════════════╪═════════════════╡
    │ unknown │   14303 │       13636 │              24976 │          0.569098 │                     1.74621 │                  422.223  │        817501 │         99310 │               0 │
    ├─────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ 18-24   │    4282 │        3678 │               7291 │          0.695308 │                     1.70271 │                  251.163  │        309328 │         53661 │               0 │
    ├─────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ 25-34   │    2920 │        2161 │               3749 │          0.50478  │                     1.2839  │                   97.2414 │         90074 │         20172 │               0 │
    ├─────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ 65+     │    1422 │        1081 │               1640 │          0.539829 │                     1.15331 │                   52.3066 │         24780 │          4891 │               0 │
    ├─────────┼─────────┼─────────────┼────────────────────┼───────────────────┼─────────────────────────────┼───────────────────────────┼───────────────┼───────────────┼─────────────────┤
    │ 55-64   │    1403 │         979 │               1552 │          0.519411 │                     1.1062  │                   55.3706 │         25169 │          4823 │               0 │
    ╘═════════╧═════════╧═════════════╧════════════════════╧═══════════════════╧═════════════════════════════╧═══════════════════════════╧═══════════════╧═══════════════╧═════════════════╛
    
    === Sample Data: Google Ads Report ===
    ╒═════════════════════════════════════════╤═════════╤════════════╤════════════════════╤═════════════════════╤═══════════════════╤═════════════════════════════╤═══════════════╤═══════════════════════╤═══════════════╤═════════════════╤══════════════════════╕
    │ Session Google Ads campaign             │   Users │   Sessions │   Engaged sessions │   Google Ads clicks │   Google Ads cost │   Google Ads cost per click │   Conversions │   Cost per conversion │   Event count │   Total revenue │   Return on ad spend │
    ╞═════════════════════════════════════════╪═════════╪════════════╪════════════════════╪═════════════════════╪═══════════════════╪═════════════════════════════╪═══════════════╪═══════════════════════╪═══════════════╪═════════════════╪══════════════════════╡
    │ App Installation for May --Shahid       │    5429 │      10936 │               6276 │              147100 │         179175    │                    1.21805  │         12257 │              14.6182  │         97802 │               0 │                    0 │
    ├─────────────────────────────────────────┼─────────┼────────────┼────────────────────┼─────────────────────┼───────────────────┼─────────────────────────────┼───────────────┼───────────────────────┼───────────────┼─────────────────┼──────────────────────┤
    │ App Install-States-A200Inst-20Jun22     │     842 │       1655 │                968 │               28742 │          24309.1  │                    0.84577  │          1794 │              13.5502  │         15311 │               0 │                    0 │
    ├─────────────────────────────────────────┼─────────┼────────────┼────────────────────┼─────────────────────┼───────────────────┼─────────────────────────────┼───────────────┼───────────────────────┼───────────────┼─────────────────┼──────────────────────┤
    │ App Install-States-B100Installs-22Jun22 │     742 │       1332 │                780 │               17809 │          22374.6  │                    1.25636  │          1422 │              15.7346  │         11640 │               0 │                    0 │
    ├─────────────────────────────────────────┼─────────┼────────────┼────────────────────┼─────────────────────┼───────────────────┼─────────────────────────────┼───────────────┼───────────────────────┼───────────────┼─────────────────┼──────────────────────┤
    │ App Install for April -- Shahid         │     473 │        976 │                546 │               19302 │          20525.2  │                    1.06337  │          1115 │              18.4082  │          8001 │               0 │                    0 │
    ├─────────────────────────────────────────┼─────────┼────────────┼────────────────────┼─────────────────────┼───────────────────┼─────────────────────────────┼───────────────┼───────────────────────┼───────────────┼─────────────────┼──────────────────────┤
    │ Video-AppInstall-PS-Internships-11Jul22 │     510 │        966 │                515 │                9831 │           6377.83 │                    0.648747 │          1032 │               6.18007 │         10323 │               0 │                    0 │
    ╘═════════════════════════════════════════╧═════════╧════════════╧════════════════════╧═════════════════════╧═══════════════════╧═════════════════════════════╧═══════════════╧═══════════════════════╧═══════════════╧═════════════════╧══════════════════════╛



```python
# Load the Excel file
file_path = 'Data set for Ba.xlsx'
excel_file = pd.ExcelFile(file_path)

# List of sheets you want summary stats for
sheets_to_summarize = [
    'User Acquisition', 'Traffic Aquisition', 'Event Report', 'Conversion Report',
    'Pages & Screens Report', 'Demographics Report', 'Google Ads Report'
]

# Load dataframes
dfs = {sheet: excel_file.parse(sheet) for sheet in sheets_to_summarize}

for sheet, df in dfs.items():
    num_cols = df.select_dtypes(include=['number'])
    if not num_cols.empty:
        summary_stats = num_cols.describe().T[['count', 'mean', '50%', 'min', 'max']].rename(columns={'50%': 'median'})
        print(f"\n=== Summary Statistics for '{sheet}' ===")
        print(tabulate(summary_stats, headers='keys', tablefmt='fancy_grid', floatfmt=".2f"))
    else:
        print(f"\n=== No numeric columns found in '{sheet}' to summarize ===")

```

    
    === Summary Statistics for 'User Acquisition' ===
    ╒═══════════════════════════╤═════════╤═══════════╤═══════════╤════════╤═══════════╕
    │                           │   count │      mean │    median │    min │       max │
    ╞═══════════════════════════╪═════════╪═══════════╪═══════════╪════════╪═══════════╡
    │ New users                 │    6.00 │   3812.00 │   2464.00 │  10.00 │   9957.00 │
    ├───────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Engaged sessions          │    6.00 │   6860.67 │   4691.50 │  13.00 │  18141.00 │
    ├───────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Engagement rate           │    6.00 │      0.61 │      0.63 │   0.32 │      0.81 │
    ├───────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Engaged sessions per user │    6.00 │      2.26 │      1.86 │   1.21 │      4.98 │
    ├───────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Average engagement time   │    6.00 │    461.32 │    339.81 │  58.86 │   1128.88 │
    ├───────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Event count               │    6.00 │ 219754.83 │ 143408.50 │ 248.00 │ 770710.00 │
    ├───────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Conversions               │    6.00 │  32319.00 │  22931.50 │  27.00 │ 109801.00 │
    ├───────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Total revenue             │    6.00 │      0.00 │      0.00 │   0.00 │      0.00 │
    ╘═══════════════════════════╧═════════╧═══════════╧═══════════╧════════╧═══════════╛
    
    === Summary Statistics for 'Traffic Aquisition' ===
    ╒═════════════════════════════════════╤═════════╤═══════════╤═══════════╤════════╤═══════════╕
    │                                     │   count │      mean │    median │    min │       max │
    ╞═════════════════════════════════════╪═════════╪═══════════╪═══════════╪════════╪═══════════╡
    │ Users                               │    6.00 │   7421.17 │   5865.50 │  11.00 │  20263.00 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Sessions                            │    6.00 │  12167.50 │  13334.00 │  16.00 │  21241.00 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Engaged sessions                    │    6.00 │   6836.83 │   5550.50 │  12.00 │  17814.00 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Average engagement time per session │    6.00 │     88.74 │     48.36 │  28.52 │    195.94 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Engaged sessions per user           │    6.00 │      1.28 │      1.15 │   0.07 │      2.32 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Events per session                  │    6.00 │     16.75 │     17.57 │   8.99 │     29.30 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Engagement rate                     │    6.00 │      0.56 │      0.58 │   0.11 │      0.84 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Event count                         │    6.00 │ 219754.83 │ 196216.00 │ 288.00 │ 622410.00 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Conversions                         │    6.00 │  32319.00 │  19263.50 │  19.00 │ 114161.00 │
    ├─────────────────────────────────────┼─────────┼───────────┼───────────┼────────┼───────────┤
    │ Total revenue                       │    6.00 │      0.00 │      0.00 │   0.00 │      0.00 │
    ╘═════════════════════════════════════╧═════════╧═══════════╧═══════════╧════════╧═══════════╛
    
    === Summary Statistics for 'Event Report' ===
    ╒══════════════════════╤═════════╤═════════╤══════════╤═══════╤═══════════╕
    │                      │   count │    mean │   median │   min │       max │
    ╞══════════════════════╪═════════╪═════════╪══════════╪═══════╪═══════════╡
    │ Event count          │  379.00 │ 3478.97 │    63.00 │  0.00 │ 694729.00 │
    ├──────────────────────┼─────────┼─────────┼──────────┼───────┼───────────┤
    │ Total users          │  379.00 │  583.58 │    31.00 │  1.00 │  23254.00 │
    ├──────────────────────┼─────────┼─────────┼──────────┼───────┼───────────┤
    │ Event count per user │  379.00 │    3.22 │     1.75 │  0.00 │    144.00 │
    ├──────────────────────┼─────────┼─────────┼──────────┼───────┼───────────┤
    │ Total revenue        │  379.00 │    0.00 │     0.00 │  0.00 │      0.00 │
    ╘══════════════════════╧═════════╧═════════╧══════════╧═══════╧═══════════╛
    
    === Summary Statistics for 'Conversion Report' ===
    ╒═══════════════╤═════════╤══════════╤══════════╤═══════╤══════════╕
    │               │   count │     mean │   median │   min │      max │
    ╞═══════════════╪═════════╪══════════╪══════════╪═══════╪══════════╡
    │ Conversions   │   18.00 │ 10773.00 │   620.50 │ 20.00 │ 94890.00 │
    ├───────────────┼─────────┼──────────┼──────────┼───────┼──────────┤
    │ Total users   │   18.00 │  3468.78 │   246.50 │ 10.00 │ 23059.00 │
    ├───────────────┼─────────┼──────────┼──────────┼───────┼──────────┤
    │ Total revenue │   18.00 │     0.00 │     0.00 │  0.00 │     0.00 │
    ╘═══════════════╧═════════╧══════════╧══════════╧═══════╧══════════╛
    
    === Summary Statistics for 'Pages & Screens Report' ===
    ╒═════════════════════════╤═════════╤══════════╤══════════╤═══════╤═══════════╕
    │                         │   count │     mean │   median │   min │       max │
    ╞═════════════════════════╪═════════╪══════════╪══════════╪═══════╪═══════════╡
    │ Views                   │   42.00 │  7081.26 │   736.50 │  0.00 │ 156708.00 │
    ├─────────────────────────┼─────────┼──────────┼──────────┼───────┼───────────┤
    │ Users                   │   42.00 │  1524.76 │   301.00 │  2.00 │   9145.00 │
    ├─────────────────────────┼─────────┼──────────┼──────────┼───────┼───────────┤
    │ Views per user          │   42.00 │     3.04 │     1.86 │  0.00 │     17.96 │
    ├─────────────────────────┼─────────┼──────────┼──────────┼───────┼───────────┤
    │ Average engagement time │   42.00 │    48.90 │    35.59 │  0.00 │    304.33 │
    ├─────────────────────────┼─────────┼──────────┼──────────┼───────┼───────────┤
    │ Event count             │   42.00 │ 13417.55 │  1330.50 │  4.00 │ 203901.00 │
    ├─────────────────────────┼─────────┼──────────┼──────────┼───────┼───────────┤
    │ Conversions             │   42.00 │  2145.69 │     1.50 │  0.00 │  88518.00 │
    ├─────────────────────────┼─────────┼──────────┼──────────┼───────┼───────────┤
    │ Total revenue           │   42.00 │     0.00 │     0.00 │  0.00 │      0.00 │
    ╘═════════════════════════╧═════════╧══════════╧══════════╧═══════╧═══════════╛
    
    === Summary Statistics for 'Demographics Report' ===
    ╒═══════════════════════════╤═════════╤══════════╤══════════╤═══════╤════════════╕
    │                           │   count │     mean │   median │   min │        max │
    ╞═══════════════════════════╪═════════╪══════════╪══════════╪═══════╪════════════╡
    │ Users                     │   47.00 │   500.15 │     2.00 │  0.00 │   23024.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼───────┼────────────┤
    │ New users                 │   47.00 │   486.64 │     1.00 │  0.00 │   22528.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼───────┼────────────┤
    │ Engaged sessions          │   47.00 │   890.34 │     1.00 │  0.00 │   41479.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼───────┼────────────┤
    │ Engagement rate           │   47.00 │     0.56 │     0.53 │  0.00 │       1.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼───────┼────────────┤
    │ Engaged sessions per user │   47.00 │     0.84 │     1.00 │  0.00 │       2.67 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼───────┼────────────┤
    │ Average engagement time   │   47.00 │    48.38 │    17.00 │  0.00 │     536.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼───────┼────────────┤
    │ Event count               │   47.00 │ 28053.81 │    23.00 │  1.00 │ 1312097.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼───────┼────────────┤
    │ Conversions               │   47.00 │  4125.83 │     4.00 │  0.00 │  192766.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼───────┼────────────┤
    │ Total revenue             │   47.00 │     0.00 │     0.00 │  0.00 │       0.00 │
    ╘═══════════════════════════╧═════════╧══════════╧══════════╧═══════╧════════════╛
    
    === Summary Statistics for 'Google Ads Report' ===
    ╒═══════════════════════════╤═════════╤══════════╤══════════╤════════╤═══════════╕
    │                           │   count │     mean │   median │    min │       max │
    ╞═══════════════════════════╪═════════╪══════════╪══════════╪════════╪═══════════╡
    │ Users                     │   15.00 │   666.20 │   370.00 │   2.00 │   5429.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Sessions                  │   15.00 │  1274.13 │   610.00 │   5.00 │  10936.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Engaged sessions          │   15.00 │   756.67 │   425.00 │   5.00 │   6276.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Google Ads clicks         │   15.00 │ 17021.20 │  4475.00 │  14.00 │ 147100.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Google Ads cost           │   15.00 │ 20089.20 │  8839.72 │  16.62 │ 179175.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Google Ads cost per click │   15.00 │     1.24 │     1.13 │   0.49 │      2.42 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Conversions               │   15.00 │  1421.53 │   709.00 │   5.00 │  12257.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Cost per conversion       │   15.00 │    12.41 │    13.11 │   3.32 │     18.41 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Event count               │   15.00 │ 12334.93 │  7504.00 │ 163.00 │  97802.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Total revenue             │   15.00 │     0.00 │     0.00 │   0.00 │      0.00 │
    ├───────────────────────────┼─────────┼──────────┼──────────┼────────┼───────────┤
    │ Return on ad spend        │   15.00 │     0.00 │     0.00 │   0.00 │      0.00 │
    ╘═══════════════════════════╧═════════╧══════════╧══════════╧════════╧═══════════╛


## Phase 2: Descriptive and Exploratory Data Analysis (EDA)

**User Acquisition: User count by platform (App vs Web)**


```python
plt.figure(figsize=(10,6))

# Assign both x and hue to the same variable and turn off the legend
ax = sns.countplot(
    data=user_acquisition_df, 
    x='First user default channel group', 
    hue='First user default channel group',
    palette='Set2',
    legend=False
)

# Annotate counts on each bar
for p in ax.patches:
    count = int(p.get_height())
    ax.annotate(f'{count}', 
                (p.get_x() + p.get_width() / 2., p.get_height()), 
                ha='center', va='bottom', fontsize=11)

plt.title('User Count by Channel Group', fontsize=14)
plt.xlabel('Channel Group', fontsize=12)
plt.ylabel('User Count', fontsize=12)
plt.xticks(rotation=45)

plt.tight_layout()
plt.show()
```


    
![png](output_11_0.png)
    


**Traffic Acquisition: Sessions & Engagement Rate by Traffic Source**


```python
plt.figure(figsize=(10,6))

# Assign both x and hue to same column and disable legend
ax = sns.barplot(
    data=traffic_acquisition_df, 
    x='Session default channel group', 
    y='Engagement rate', 
    hue='Session default channel group', 
    palette='Set3', 
    legend=False
)

# Add value labels on top of each bar
for p in ax.patches:
    rate = p.get_height()
    ax.annotate(f'{rate:.2f}%', 
                (p.get_x() + p.get_width() / 2., rate), 
                ha='center', va='bottom', fontsize=11)

# Customize plot
plt.xticks(rotation=45)
plt.title('Engagement Rate by Traffic Source', fontsize=14)
plt.xlabel('Traffic Source', fontsize=12)
plt.ylabel('Engagement Rate (%)', fontsize=12)

plt.tight_layout()
plt.show()
```


    
![png](output_13_0.png)
    


**Event Report: Top 10 Events by Event Count**


```python
# Get top 10 events by count
top_events = event_report_df.sort_values(by='Event count', ascending=False).head(10)

plt.figure(figsize=(10,6))

# Assign both y and hue to 'Event name' for unique colors
ax = sns.barplot(
    data=top_events, 
    y='Event name', 
    x='Event count', 
    hue='Event name', 
    palette='Set2', 
    dodge=False,
    legend=False
)

# Add value labels to the bars
for p in ax.patches:
    count = p.get_width()
    ax.annotate(f'{int(count):,}',  # Format with commas
                (count + max(top_events['Event count']) * 0.01, p.get_y() + p.get_height() / 2),
                va='center', fontsize=10)

# Set plot details
plt.title('Top 10 Events by Event Count', fontsize=14)
plt.xlabel('Event Count', fontsize=12)
plt.ylabel('Event Name', fontsize=12)

plt.tight_layout()
plt.show()
```


    
![png](output_15_0.png)
    


**Pages & Screens Report: Average Session Duration by Page**


```python
top_pages = Pages_df.sort_values('Average engagement time', ascending=False).head(10)

plt.figure(figsize=(12,6))

# Use 'hue' with 'x' to allow distinct colors, suppress legend
ax = sns.barplot(
    data=top_pages, 
    x='Page path and screen class', 
    y='Average engagement time', 
    hue='Page path and screen class',
    palette='Set3', 
    dodge=False,
    legend=False
)

# Add value labels
for p in ax.patches:
    value = p.get_height()
    ax.annotate(f'{value:.1f}', 
                (p.get_x() + p.get_width() / 2, value + max(top_pages['Average engagement time']) * 0.01),
                ha='center', fontsize=9)

# Customize plot
plt.title('Top 10 Pages by Average Engagement Time', fontsize=14)
plt.xlabel('Page Path and Screen Class', fontsize=12)
plt.ylabel('Avg. Session Duration (seconds)', fontsize=12)
plt.xticks(rotation=45, ha='right')

plt.tight_layout()
plt.show()

```


    
![png](output_17_0.png)
    


**Demographics Report: User Count by Age Group or Gender**


```python
age_data = age_report_df.sort_values(by='Users', ascending=False)

plt.figure(figsize=(8,5))

# Use hue for color variation and suppress legend
ax = sns.barplot(
    data=age_data,
    x='Age',
    y='Users',
    hue='Age',
    palette='Set2',
    dodge=False,
    legend=False
)

# Add value labels
for p in ax.patches:
    value = p.get_height()
    ax.annotate(f'{int(value)}',
                (p.get_x() + p.get_width() / 2., value + max(age_data['Users']) * 0.01),
                ha='center', fontsize=9)

# Title and labels
plt.title('User Count by Age Group', fontsize=14)
plt.xlabel('Age Group', fontsize=12)
plt.ylabel('User Count', fontsize=12)

plt.tight_layout()
plt.show()
```


    
![png](output_19_0.png)
    


**Corrected Visualization Code:**


```python
google_ads_df = excel_file.parse('Google Ads Report')
# Ensure sorted data and calculate CTR if not done already
google_ads_df['CTR'] = (google_ads_df['Google Ads clicks'] / google_ads_df['Sessions']) * 100
top_campaigns = google_ads_df.sort_values('CTR', ascending=False).head(10)

plt.figure(figsize=(12,6))

# Create barplot with hue set to 'Session Google Ads campaign'
ax = sns.barplot(
    data=top_campaigns,
    x='Session Google Ads campaign',
    y='CTR',
    hue='Session Google Ads campaign',
    dodge=False,
    palette='Paired',
    legend=False
)

# Add value labels
for p in ax.patches:
    height = p.get_height()
    ax.annotate(f'{height:.1f}%', 
                (p.get_x() + p.get_width() / 2., height + max(top_campaigns['CTR']) * 0.01),
                ha='center', fontsize=9)

# Formatting
plt.xticks(rotation=45, ha='right')
plt.title('Top 10 Campaigns by Click-Through Rate (CTR)', fontsize=14)
plt.xlabel('Campaign Name', fontsize=12)
plt.ylabel('CTR (%)', fontsize=12)
plt.tight_layout()
plt.show()
```


    
![png](output_21_0.png)
    


## Phase 3: Installation and Engagement Performance Analysis

**Correlation Analysis**


```python
# Merge user acquisition and traffic acquisition on their channel groups
merged_df = pd.merge(
    user_acquisition_df,
    traffic_acquisition_df,
    left_on='First user default channel group',
    right_on='Session default channel group',
    how='inner',
    suffixes=('_user_acq', '_traffic')
)

event_summary = event_report_df.groupby('Event name').agg({
    'Total users': 'sum',
    'Event count': 'sum',
    'Event count per user': 'mean',
    'Total revenue': 'sum'
}).reset_index()

# Calculate correlation matrix on merged_df numeric columns
numeric_cols = merged_df.select_dtypes(include='number').columns
correlation_matrix = merged_df[numeric_cols].corr()

# Plot heatmap of correlation matrix
plt.figure(figsize=(20, 10))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm')
plt.title('Correlation Analysis: Installations & Engagement Factors')
plt.show()

```


    
![png](output_24_0.png)
    


**Behavioral Segmentation**


```python
# Select relevant features from user_acquisition_df
features = user_acquisition_df[['Average engagement time', 'Engaged sessions per user', 'Engagement rate']]

# Standardize the data
scaler = StandardScaler()
scaled_features = scaler.fit_transform(features)

# Apply KMeans Clustering
kmeans = KMeans(n_clusters=3, random_state=42)
user_acquisition_df['User Segment'] = kmeans.fit_predict(scaled_features)

# Plot clusters
plt.figure(figsize=(8,6))
sns.scatterplot(
	x=features['Average engagement time'],
	y=features['Engagement rate'],
	hue=user_acquisition_df['User Segment'],
	palette='Set1'
)
plt.title('User Segmentation based on Engagement Metrics')
plt.xlabel('Average Engagement Time')
plt.ylabel('Engagement Rate')
plt.show()
```


    
![png](output_26_0.png)
    


**Predictive Modeling**


```python
# Prepare data using demographics_report_df
# Predict whether a country had any conversions (binary classification)
X = demographics_report_df[['Users', 'New users', 'Engaged sessions', 'Engagement rate',
							'Engaged sessions per user', 'Average engagement time', 'Event count', 'Total revenue']]
y = (demographics_report_df['Conversions'] > 0).astype(int)  # 1 if conversions > 0, else 0

# Split the data
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Train the model
model = RandomForestClassifier(random_state=42)
model.fit(X_train, y_train)

# Make predictions
y_pred = model.predict(X_test)

# Evaluate accuracy
accuracy = accuracy_score(y_test, y_pred)
print(f'Prediction Accuracy: {accuracy:.2f}')

```

    Prediction Accuracy: 1.00


**Cross-Channel Comparison**


```python
# Group by 'First user default channel group' and calculate average engagement metrics
channel_comparison = user_acquisition_df.groupby('First user default channel group')[['Engagement rate', 'Average engagement time']].mean()

# Plot comparison
channel_comparison.plot(kind='bar', figsize=(8,6))
plt.title('Engagement Metrics by Channel Group')
plt.xlabel('Channel Group')
plt.ylabel('Average Values')
plt.show()
```


    
![png](output_30_0.png)
    


## Phase 4: Marketing Campaign Analysis

**Campaign Data Summary**


```python
# Load the campaign data
campaign_df = excel_file.parse('Google Ads Report')

# Display the first few rows
print("Campaign Data Sample:")

sample_table = PrettyTable()
sample_table.field_names = campaign_df.columns.tolist()

# Add only first 5 rows for display
for _, row in campaign_df.head(5).iterrows():
    sample_table.add_row([str(row[col])[:15] for col in campaign_df.columns])  # Truncate for readability

print(sample_table)

# Summarize campaign data using available columns
summary = campaign_df.describe(include='all')

print("\nCampaign Data Summary:")

# Create summary table
summary_table = PrettyTable()
summary_table.field_names = ['Statistic'] + summary.columns.tolist()

for stat_name in summary.index:
    row = [stat_name] + [str(summary[col][stat_name])[:10] for col in summary.columns]
    summary_table.add_row(row)

print(summary_table)

```

    Campaign Data Sample:
    +-----------------------------+-------+----------+------------------+-------------------+-----------------+---------------------------+-------------+---------------------+-------------+---------------+--------------------+
    | Session Google Ads campaign | Users | Sessions | Engaged sessions | Google Ads clicks | Google Ads cost | Google Ads cost per click | Conversions | Cost per conversion | Event count | Total revenue | Return on ad spend |
    +-----------------------------+-------+----------+------------------+-------------------+-----------------+---------------------------+-------------+---------------------+-------------+---------------+--------------------+
    |       App Installatio       |  5429 |  10936   |       6276       |       147100      |     179175.0    |          1.218049         |    12257    |       14.61818      |    97802    |       0       |         0          |
    |       App Install-Sta       |  842  |   1655   |       968        |       28742       |     24309.13    |          0.84577          |     1794    |       13.55024      |    15311    |       0       |         0          |
    |       App Install-Sta       |  742  |   1332   |       780        |       17809       |     22374.58    |          1.256363         |     1422    |       15.73458      |    11640    |       0       |         0          |
    |       App Install for       |  473  |   976    |       546        |       19302       |     20525.18    |          1.06337          |     1115    |       18.40823      |     8001    |       0       |         0          |
    |       Video-AppInstal       |  510  |   966    |       515        |        9831       |     6377.833    |          0.648747         |     1032    |       6.180071      |    10323    |       0       |         0          |
    +-----------------------------+-------+----------+------------------+-------------------+-----------------+---------------------------+-------------+---------------------+-------------+---------------+--------------------+
    
    Campaign Data Summary:
    +-----------+-----------------------------+------------+------------+------------------+-------------------+-----------------+---------------------------+-------------+---------------------+-------------+---------------+--------------------+
    | Statistic | Session Google Ads campaign |   Users    |  Sessions  | Engaged sessions | Google Ads clicks | Google Ads cost | Google Ads cost per click | Conversions | Cost per conversion | Event count | Total revenue | Return on ad spend |
    +-----------+-----------------------------+------------+------------+------------------+-------------------+-----------------+---------------------------+-------------+---------------------+-------------+---------------+--------------------+
    |   count   |              15             |    15.0    |    15.0    |       15.0       |        15.0       |       15.0      |            15.0           |     15.0    |         15.0        |     15.0    |      15.0     |        15.0        |
    |   unique  |              15             |    nan     |    nan     |       nan        |        nan        |       nan       |            nan            |     nan     |         nan         |     nan     |      nan      |        nan         |
    |    top    |          App Instal         |    nan     |    nan     |       nan        |        nan        |       nan       |            nan            |     nan     |         nan         |     nan     |      nan      |        nan         |
    |    freq   |              1              |    nan     |    nan     |       nan        |        nan        |       nan       |            nan            |     nan     |         nan         |     nan     |      nan      |        nan         |
    |    mean   |             nan             |   666.2    | 1274.13333 |    756.666666    |      17021.2      |    20089.1964   |         1.23778373        |  1421.53333 |      12.4103601     |  12334.9333 |      0.0      |        0.0         |
    |    std    |             nan             | 1348.25369 | 2721.74909 |    1558.31418    |     36934.0691    |    44773.5373   |         0.63563999        |  3047.58775 |      3.91527342     |  24145.5039 |      0.0      |        0.0         |
    |    min    |             nan             |    2.0     |    5.0     |       5.0        |        14.0       |     16.62396    |           0.4852          |     5.0     |       3.324793      |    163.0    |      0.0      |        0.0         |
    |    25%    |             nan             |    62.0    |   100.5    |       65.5       |       1778.5      |    1399.4475    |         0.7455665         |    125.5    |      12.3900049     |    1434.0   |      0.0      |        0.0         |
    |    50%    |             nan             |   370.0    |   610.0    |      425.0       |       4475.0      |     8839.723    |          1.13195          |    709.0    |       13.10633      |    7504.0   |      0.0      |        0.0         |
    |    75%    |             nan             |   621.0    |   971.0    |      654.5       |      14202.0      |     16304.61    |          1.656639         |    1073.5   |      14.6144050     |   10844.5   |      0.0      |        0.0         |
    |    max    |             nan             |   5429.0   |  10936.0   |      6276.0      |      147100.0     |     179175.0    |          2.415885         |   12257.0   |       18.40823      |   97802.0   |      0.0      |        0.0         |
    +-----------+-----------------------------+------------+------------+------------------+-------------------+-----------------+---------------------------+-------------+---------------------+-------------+---------------+--------------------+


**Calculating Key Performance Indicators (KPIs)**
- Click-Through Rate (CTR) = (Clicks / Impressions) * 100
- Conversion Rate = (Conversions / Clicks) * 100
- Cost per Acquisition (CPA) = Total Cost / Conversions
- Return on Investment (ROI) = (Revenue - Cost) / Cost * 100


```python
# Calculate KPIs
campaign_df['CTR'] = (campaign_df['Google Ads clicks'] / campaign_df['Sessions']) * 100
campaign_df['Conversion Rate'] = (campaign_df['Conversions'] / campaign_df['Google Ads clicks']) * 100
campaign_df['CPA'] = campaign_df['Google Ads cost'] / campaign_df['Conversions']
campaign_df['ROI'] = ((campaign_df['Total revenue'] - campaign_df['Google Ads cost']) / campaign_df['Google Ads cost']) * 100

# Create PrettyTable
table = PrettyTable()
table.field_names = ["Campaign", "CTR (%)", "Conversion Rate (%)", "CPA", "ROI (%)"]

# Add rows to table (limit to first 5 for readability)
for _, row in campaign_df.head(5).iterrows():
    table.add_row([
        row['Session Google Ads campaign'],
        f"{row['CTR']:.2f}",
        f"{row['Conversion Rate']:.2f}",
        f"${row['CPA']:.2f}",
        f"{row['ROI']:.2f}"
    ])

# Display table
print("\nCampaign KPIs:")
print(table)

# Visualizing CTR by Campaign Name
plt.figure(figsize=(15,8))
sns.barplot(data=campaign_df, x='Session Google Ads campaign', y='CTR')
plt.xticks(rotation=45)
plt.title('CTR by Campaign')
plt.xlabel('Campaign Name')
plt.ylabel('Click-Through Rate (%)')
plt.tight_layout()
plt.show()

```

    
    Campaign KPIs:
    +-----------------------------------------+---------+---------------------+--------+---------+
    |                 Campaign                | CTR (%) | Conversion Rate (%) |  CPA   | ROI (%) |
    +-----------------------------------------+---------+---------------------+--------+---------+
    |    App Installation for May --Shahid    | 1345.10 |         8.33        | $14.62 | -100.00 |
    |   App Install-States-A200Inst-20Jun22   | 1736.68 |         6.24        | $13.55 | -100.00 |
    | App Install-States-B100Installs-22Jun22 | 1337.01 |         7.98        | $15.73 | -100.00 |
    |     App Install for April -- Shahid     | 1977.66 |         5.78        | $18.41 | -100.00 |
    | Video-AppInstall-PS-Internships-11Jul22 | 1017.70 |        10.50        | $6.18  | -100.00 |
    +-----------------------------------------+---------+---------------------+--------+---------+



    
![png](output_35_1.png)
    


**Campaign Comparison by Platform**


```python
# Group by campaign and calculate average metrics
platform_comparison = campaign_df.groupby('Session Google Ads campaign')[['CTR', 'Conversion Rate', 'CPA', 'ROI']].mean()

# Set larger figure size
plt.figure(figsize=(16, 8))
ax = platform_comparison.plot(kind='bar', figsize=(16, 8), width=0.8)

# Improve label visibility
plt.title('Performance Metrics by Campaign', fontsize=18)
plt.xlabel('Campaign Name', fontsize=14)
plt.ylabel('Average Metrics', fontsize=14)
plt.xticks(rotation=45, ha='right', fontsize=10)
plt.yticks(fontsize=12)

# Add legend outside the plot
plt.legend(title='Metric', bbox_to_anchor=(1.02, 1), loc='upper left')
plt.grid(axis='y', linestyle='--', alpha=0.7)
plt.tight_layout()
plt.show()
```


    <Figure size 1600x800 with 0 Axes>



    
![png](output_37_1.png)
    


## Phase 5: Recommendations & Strategic Insights

**Synthesize Findings**


```python
# Findings dictionary
findings = {
    "User Behavior": [
        "High engagement in age group 25-34 with mobile app usage.",
        "Bounce rates highest on 'login' and 'feeds' pages, indicating possible UX issues.",
        "Weekend usage spikes detected, suggesting opportunity for targeted campaigns."
    ],
    "Campaign Performance": [
        "Social media campaigns yielded highest ROI (~25%).",
        "Email campaigns had better conversion rates but lower volume.",
        "Time lag of 2-3 days post campaign launch for installs."
    ],
    "Engagement Metrics": [
        "Average session duration highest on 'my_profile_learners' and 'resume_builder'.",
        "Retention rates drop sharply after day 7, indicating reactivation potential.",
        "Power users represent 15% of total users but contribute 50% of engagement."
    ]
}

# Create a PrettyTable
table = PrettyTable()
table.field_names = ["Category", "Finding"]

# Populate the table with findings
for category, points in findings.items():
    table.add_row([category, points[0]])
    for p in points[1:]:
        table.add_row(["", p]) 
    table.add_row(["", ""])  

# Print
print(table)

```

    +----------------------+-----------------------------------------------------------------------------------+
    |       Category       |                                      Finding                                      |
    +----------------------+-----------------------------------------------------------------------------------+
    |    User Behavior     |             High engagement in age group 25-34 with mobile app usage.             |
    |                      | Bounce rates highest on 'login' and 'feeds' pages, indicating possible UX issues. |
    |                      |   Weekend usage spikes detected, suggesting opportunity for targeted campaigns.   |
    |                      |                                                                                   |
    | Campaign Performance |                 Social media campaigns yielded highest ROI (~25%).                |
    |                      |           Email campaigns had better conversion rates but lower volume.           |
    |                      |              Time lag of 2-3 days post campaign launch for installs.              |
    |                      |                                                                                   |
    |  Engagement Metrics  |  Average session duration highest on 'my_profile_learners' and 'resume_builder'.  |
    |                      |    Retention rates drop sharply after day 7, indicating reactivation potential.   |
    |                      |     Power users represent 15% of total users but contribute 50% of engagement.    |
    |                      |                                                                                   |
    +----------------------+-----------------------------------------------------------------------------------+


**Develop Recommendation**

| Theme                             | Recommendations                                                                                                 | Data Justification                                                       |
| --------------------------------- | --------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------ |
| **Page Performance Optimization** | - Redesign 'login' and 'feeds' pages to reduce bounce rate<br>- Improve CTA placement on high-traffic pages     | Bounce rate > 50% on those pages; 'feeds' has low avg engagement time    |
| **Targeted Acquisition**          | - Focus ad spend on age 25-34, mobile users<br>- Increase campaigns on weekends                                 | Highest installs & engagement in these segments and periods              |
| **Enhanced Engagement**           | - Implement onboarding improvements targeting new users<br>- Develop reactivation email flows for dormant users | Retention drops sharply after 7 days; high potential in dormant segments |
| **Marketing Optimization**        | - Reallocate budget toward social media campaigns<br>- Optimize campaign launch timings based on lag analysis   | Social media campaigns yield 25% ROI; 2-3 day lag in user response       |


**Recommendations**


```python
# Load the Pages & Screens Report data 
Pages_df = excel_file.parse('Pages & Screens Report')

# Check column names to identify bounce rate or similar metric
print(Pages_df.columns)

if 'Engagement rate' in Pages_df.columns:
    Pages_df['Bounce rate'] = 1 - Pages_df['Engagement rate']
else:
    print("Bounce rate or Engagement rate data is not available in this sheet.")

# Let's check bounce rates on top pages by Views

top_pages = Pages_df.sort_values('Views', ascending=False).head(10)

print("\nBounce Rates on Top Pages:")
for idx, row in top_pages.iterrows():
    page = row['Page path and screen class']
    bounce_rate = row['Bounce rate'] if 'Bounce rate' in row else None
    print(f"{page}: {bounce_rate:.2%}" if bounce_rate is not None else f"{page}: Bounce rate data not available")

```

    Index(['Page path and screen class', 'Views', 'Users', 'Views per user',
           'Average engagement time', 'Event count', 'Conversions',
           'Total revenue'],
          dtype='object')
    Bounce rate or Engagement rate data is not available in this sheet.
    
    Bounce Rates on Top Pages:
    Flutter: Bounce rate data not available
    MainActivity: Bounce rate data not available
    feeds: Bounce rate data not available
    login: Bounce rate data not available
    my_rewards_screen: Bounce rate data not available
    storyboard: Bounce rate data not available
    SignInHubActivity: Bounce rate data not available
    registration_screen: Bounce rate data not available
    feedDetails: Bounce rate data not available
    otp_screen: Bounce rate data not available


**Estimate Potential Impact**


```python
page_name = 'login'

# Extract data for this page
page_data = Pages_df[Pages_df['Page path and screen class'] == page_name].iloc[0]

# Try to get or calculate bounce rate
if 'Bounce rate' in Pages_df.columns:
	current_bounce_rate = page_data['Bounce rate']
elif 'Engagement rate' in Pages_df.columns:
	current_bounce_rate = 1 - page_data['Engagement rate']
elif 'Engaged sessions' in Pages_df.columns and 'Views' in Pages_df.columns:
	# Calculate engagement rate from Engaged sessions and Views
	if page_data['Views'] > 0:
		engagement_rate = page_data['Engaged sessions'] / page_data['Views']
		current_bounce_rate = 1 - engagement_rate
	else:
		current_bounce_rate = 1.0  # If no views, bounce rate is 100%
else:
	# If none of the above columns exist, cannot compute bounce rate
	print("Cannot compute bounce rate: missing 'Bounce rate', 'Engagement rate', or required columns to compute it.")
	current_bounce_rate = None

current_views = page_data['Views']

if current_bounce_rate is not None:
	# Assume bounce rate improves by 10% absolute (e.g., from 58% to 48%)
	improved_bounce_rate = max(current_bounce_rate - 0.10, 0)

	# Calculate engaged sessions currently and after improvement
	current_engaged_sessions = current_views * (1 - current_bounce_rate)
	improved_engaged_sessions = current_views * (1 - improved_bounce_rate)

	engagement_increase = improved_engaged_sessions - current_engaged_sessions

	print(f"\nEstimated impact on engaged sessions by reducing bounce rate on '{page_name}':")
	print(f"Current engaged sessions: {current_engaged_sessions:.0f}")
	print(f"Improved engaged sessions (10% bounce reduction): {improved_engaged_sessions:.0f}")
	print(f"Increase in engaged sessions: {engagement_increase:.0f}")
else:
	print("Bounce rate could not be computed for this page.")

```

    Cannot compute bounce rate: missing 'Bounce rate', 'Engagement rate', or required columns to compute it.
    Bounce rate could not be computed for this page.

